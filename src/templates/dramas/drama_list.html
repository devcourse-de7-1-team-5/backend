{% load static %}
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>드라마 트렌드</title>
    <link rel="stylesheet" href="{% static 'dramas/drama_dashboard.css' %}">
</head>
<body>

    <header>
        <h1>📺 드라마 트렌드 한눈에 보기</h1>
        <div class="filters">
            <select id="yearSelect">
                <option value="all">전체 연도</option>
                {% for year in year_list %}
                    <option value="{{ year }}">{{ year }}년</option>
                {% endfor %}
            </select>

            <select id="genreSelect">
                <option value="all">전체 장르</option>
                {% for genre in genre_list %}
                    <option value="{{ genre }}">{{ genre }}</option>
                {% endfor %}
            </select>
        </div>
    </header>

    <main>
        {% if dramas %}
        <section class="drama-grid">
            {% for drama in dramas %}
            <div class="drama-card" data-year="{{ drama.start_date.year }}" data-genre="{{ drama.genre }}">
                <div class="thumbnail">
                    {% if drama.img_url %}
                        <img src="{{ drama.img_url }}" alt="{{ drama.title }}">
                    {% else %}
                        <img src="{% static 'dramas/images/default_thumb.jpg' %}" alt="No Image">
                    {% endif %}
                </div>
                <div class="drama-info">
                    <h2 class="title">{{ drama.title }}</h2>
                    <p class="channel">{{ drama.channel }}</p>
                    <p class="period">{{ drama.start_date }} ~ {{ drama.end_date|default:"방영 중" }}</p>
                    <p class="genre">
                        장르:
                        {% if drama.genres.all %}
                            {% for g in drama.genres.all|slice:":3" %}
                                {{ g.name }}{% if not forloop.last %}, {% endif %}
                            {% endfor %}
                            {% if drama.genres.count > 3 %} ...{% endif %}
                        {% else %}
                            정보 없음
                        {% endif %}
                    </p>

                    <p class="desc">{{ drama.description|truncatechars:100|default:"줄거리 정보 없음" }}</p>
                </div>

            </div>
            {% endfor %}
        </section>
        {% else %}
        <p class="empty">등록된 드라마가 없습니다.</p>
        {% endif %}
    </main>

</body>
</html>
